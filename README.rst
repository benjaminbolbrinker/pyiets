pyIETS — A code for calculating inelastic tunneling spectra
======

This program calculates inelastic tunneling spectra of molecules between molecular junctions using the ansatz from Troisi[1].
It reads vibrational modes from the output of the program SNF [2] which is part of the MoViPac package [3]. For each mode two 
static singlepoint calculations are performed - one for each distorted molecule - using Turbomole[4]. Greensmatrices are calculated 
using the code ARTAIOS[5] for each distorted molecule.

Getting started
===============

Make sure Turbomole_ :cite:`turbomole2010development`, ARTAIOS_ :cite:`deffner2009artaios` and pyIETS are properly (see :ref:`installation-label`).

For this program to function three inputfiles have to be provided:

- :code:`input.json`: the main control file of the program containg containing (see :ref:`here <inputjson-label>`)

  - general settings 
  - options for single point calculation

- :code:`artaios.in`: control file for spin-dependent electron transport calculations for molecular junctions
- :code:`snf.out`: output file from previous calculation of vibrational normal modes


When all three input files are provided type 

.. code-block:: bash

   pyiets.py .

.. _installation-label:

Installation
============
This program requires Turbomole_ :cite:`turbomole2010development` and ARTAIOS_ :cite:`deffner2009artaios` to be properly installed on your machine.

For installing this package simply type:

.. code-block:: bash

   pip3 install --user --upgrade pyiets

To confirm the environment was installed properly type:

.. code-block:: bash

   make test_all

.. _Turbomole: http://www.turbomole.com/
.. _ARTAIOS: https://www.chemie.uni-hamburg.de/institute/ac/arbeitsgruppen/herrmann/software/artaios.html 

.. _documentation-label:

Documentation
=============

In the following sections explain all relevant input files and corresponding parameters.

.. _inputfiles-label:

Inputfiles
----------

.. _inputjson-label: 

:code:`input.json`
^^^^^^^^^^^^^^^^^^

- :code:`sp_control` dictionary containing options for single point calculation:
   - :code:`qc_prog` string defining the quantum chemistry program (default: :code:`"turbomole"`).
   - :code:`params` dictionary containing parameters for single point calculation (default: :code:`null`). 
      - here you can set all parameters provided by ASE to control the single point calculations started by pyIETS. If you use turbomole a list of all parameters can be seen here ASE-turbomole_.

- :code:`sp_restart` if set to :code:`true` looks for :code:`mode_folder` and :code:`output_folder` to restart old calculations. This can save a lot of time and resources (default: :code:`false`). Do not change to :code:`true` if you changed parameters after the prior run of pyIETS.

- :code:`artaios` absolute path to the folder where artaios is installed (default: :code:`null`).

- :code:`artaios_bin` relative to :code:`artaios` path to artaios executable (default: :code:`bin/artaios`).

- :code:`iets_out_file` name or path of output file. This file is generated by running pyIETS (default: :code:`iets.dat`).

- :code:`mp` number of cores to be used. pyIETS will start TURBOMOLE and ARTAIOS on different cores. Depending on the functional and basis set you use the single point calculations are the most time consuming part of the calculation. The number of single point calculations performed by the pyIETS is proportional to the number of modes one specifies in :code:`modes`. A total of 2* :code:`modes` + 1 single point calculations are performed. For highest efficiency choose a multiple of this value (default: :code:`1`).

- :code:`modes` either a string or a list of integers specifying the modes for which pyIETS calculates inelastric tunneling intensities. If a list is provided the vibrational modes in the :code:`snf.out` file are accessed by index. Note however, indexing starts from 0. That means modes 1, 2, 3 in the :code:`snf.out` file are accessed by :code:`[0, 1, 2]` (default: :code:`"all"`).

.. _artaiosin-label: 

:code:`artaios.in`
^^^^^^^^^^^^^^^^^^

This input file will be used to perform the electron transport calculation.
Note: the :code:`print_green` parameter has to be provided explicitly!


.. _snfout-label: 

:code:`snf.out`
^^^^^^^^^^^^^^^

This file has to be created by a prior SNF calculations to calculate vibrational normal modes.


.. _ASE-turbomole: https://wiki.fysik.dtu.dk/ase/ase/calculators/turbomole.html

Example
-------
Examples are provided in `tests/`. Type

    $ make test_all

to test the correct installation of this module.


Please cite this work as
------
    [1] B. Bolbrinker, M. Deffner, M. Zoellner, and C. Herrmann.
    pyIETS — a code for calculating inelastic tunneling spectra, available from
    https://github.com/


References
-----
    [1] Troisi, A. (2008). Inelastic electron tunnelling in saturated molecules
    with different functional groups: correlations and symmetry considerations
    from a computational study. Journal of Physics: Condensed Matter,
    20(37), 374111.
    [2] J. Neugebauer, M. Reiher, C. Kind, B. A. Hess, J. Comput. Chem. 23
    2002, 895-910.
    [3] T. Weymuth, M. P. Haag, K. Kiewisch, S. Luber, S. Schenk, Ch. R. Jacob,
    C. Herrmann, J. Neugebauer, M. Reiher, MOVIPAC: Vibrational spectroscopy
    with a robust meta-program for massively parallel standard and inverse
    calculations, J. Chem. Comput., 2012, DOI: 10.1002/jcc.23036.
    [4] TURBOMOLE V6.2 2010, a development of University of Karlsruhe and
    Forschungszentrum Karlsruhe GmbH, 1989-2007, TURBOMOLE GmbH, since 2007;
    available from http://www.turbomole.com.w
    [5] M. Deffner, L. Groß, T. Steenbock, B. A. Voigt, G. C. Solomon,
    and C. Herrmann. Artaios — a  code for postprocessing quantum chemical
    electronic structure calculations, available from
    https://www.chemie.uni-hamburg.de/ac/herrmann/software/index.html
    (2008-2017)
